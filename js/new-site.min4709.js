let map,markers=[],lng,isMobile={Windows:()=>/IEMobile/i.test(navigator.userAgent),Android:()=>/Android/i.test(navigator.userAgent),BlackBerry:()=>/BlackBerry/i.test(navigator.userAgent),iOS:()=>/iPhone|iPad|iPod/i.test(navigator.userAgent),any:()=>isMobile.Android()||isMobile.BlackBerry()||isMobile.iOS()||isMobile.Windows(),isWrapper:()=>{try{return window.webkit.messageHandlers.observe.postMessage("testWrapper"),!0}catch(e){return!1}}},showAutofilled=!0,mobileMenu=!0,siteDomain=window.location.hostname.split("."),enabledLangs=(siteDomain=void 0!==siteDomain[2]?siteDomain[1]+"."+siteDomain[2]:siteDomain[0]+"."+siteDomain[1],["EN","FR","PT"]),waitForStyle=()=>new Promise((e,t)=>{"none"!==window.getComputedStyle(document.body,null).display?e():setTimeout(()=>{waitForStyle().then(e,t)},50)}),passwordConfirmationReceived=($(document).ready(()=>{var e,t;"string"!=typeof pathLangPrefix&&(e=window.location.pathname.split("/"),window.pathLangPrefix=1<e.length&&enabledLangs.includes(e[1].toUpperCase())?"/"+e[1].toLowerCase():""),"object"!=typeof jsTranslations&&$.getJSON(pathLangPrefix+"/services/js-translations/",e=>{window.jsTranslations=e,$(document).trigger("translations-loaded")}),$(window).scroll(function(){var e=$("div.header");$(window).scrollTop()>e.height()?e.addClass("scroll"):e.removeClass("scroll")}),waitForStyle().then(()=>{var e,t;(mobileMenu="none"!==window.getComputedStyle(document.getElementById("mobileMenuButton"),null).display)?(isMobile.isWrapper()?($("#mobileMenuButton").click(e=>{e.preventDefault(),sendToWrapper("openMenu",!1)}),t=document.getElementById("mainJs").src.split("v=")[1],(e=document.createElement("script")).type="text/javascript",e.id="wrapperHandler",e.async=!0,e.src="/js/wrapperHandler.min.js?v="+t,document.head.appendChild(e)):$("#mobileMenuButton").click(e=>{$("body").toggleClass("menuOpen"),$("body").hasClass("menuOpen")?($(e.currentTarget).text(jsTranslations.close_btn),$("#menu").scrollTop(-1e3)):$(e.currentTarget).text(jsTranslations.menu)}),$(".main-list .resource-link").prependTo($("#resource-nav")),$(".pp-tc-links").clone().appendTo("div.header #menu"),(t=document.createElement("ul")).className="language-nav",$("div.header #menu").append(t),$(".languageChange").appendTo(t),$(".social-links").clone().appendTo("div.header #menu"),$(".copyright").clone().appendTo("div.header #menu"),$("div.header #menu ul.main-list li.following-ai").remove()):$("div.dropdown-content").each(function(e){var t=$(this).prev().attr("class").split(" ").pop();$(this).appendTo("#menu li."+t)})}),$(".languageChange").find("a").click(e=>{e.preventDefault(),changeLanguage($(e.currentTarget).attr("href"))}),$("p.existingUserP span").click(()=>{sendToWrapper("loginBoxOpened",showSignUpPopUp)}),$("#menu li").click(a=>{if($(a.currentTarget).hasClass("menuOverride")){if($("#mobileMenuButton").is(":visible")&&($("body").toggleClass("menuOpen"),$("#mobileMenuButton").text(jsTranslations.menu)),$(a.currentTarget).hasClass("emailUs"))showContactUs(),$(".menu-link").click();else if($(a.currentTarget).hasClass("showLoginPopUp"))sendToWrapper("loginBoxOpened",showLoginPopUp),$(".menu-link").click();else if($(a.currentTarget).hasClass("showSignupPopUp"))sendToWrapper("loginBoxOpened",showSignUpPopUp),$(".menu-link").click();else if($(a.currentTarget).hasClass("forgotPassword"))showForgotPassword(),$(".menu-link").click();else if($(a.currentTarget).hasClass("logout"))logout();else if(!$(a.currentTarget).hasClass("lang-container"))if($(a.currentTarget).hasClass("trackPageView")){let e=$(a.currentTarget).data("fp"),t=$(a.currentTarget).data("href");sendPageViewToGTM(e,!1,()=>{navigateWithLang(t)})}else navigateWithLang($(a.currentTarget).data("href"))}else $(a.currentTarget).hasClass("dropdown")&&($(a.currentTarget).next("div.dropdown-content").toggleClass("drop-open"),$(a.currentTarget).toggleClass("drop-open"))}),$(".contact-us-form").click(e=>{e.preventDefault(),showContactUs()}),$(".user-search").click(e=>{$(e.currentTarget).data("href")?navigateWithLang($(e.currentTarget).data("href")):$(e.currentTarget).data("id")&&$(".superMap[data-id="+$(e.currentTarget).data("id")+"]").click()}),$("[data-href]").click(t=>{if("/payment/"===$(t.currentTarget).data("href"))sendPageViewToGTM("/FP/buyMoreSearches/?clickedFrom="+location.pathname,!1,()=>{navigateWithLang("/payment/")});else if($(t.currentTarget).hasClass("as-seen-link")){let e=$(t.currentTarget).data("href");sendToWrapper(["openNewWindow",encodeURIComponent(e)],()=>{window.open(e)})}else $(t.currentTarget).hasClass("menuOverride")||navigateWithLang($(t.currentTarget).data("href"))}),$("#chkNewCustomer").change(e=>{$(e.currentTarget).is(":checked")?($("#password").attr("placeholder",jsTranslations.choose_password),$("#password").attr("autocomplete","new-password"),$("#confirmPassword").attr("autocomplete","new-password"),$("#confirmPassword").removeClass("hidden")):($("#password").attr("placeholder",jsTranslations.enter_password),$("#password").attr("autocomplete","current-password"),$("#confirmPassword").attr("autocomplete","current-password"),$("#confirmPassword").addClass("hidden"))}),$("#chkNewCustomerLogin").change(e=>{$(e.currentTarget).is(":checked")?$(".confirmPassword-login-container").removeClass("hidden"):$(".confirmPassword-login-container").addClass("hidden")}),-1!==location.hash.indexOf("login")&&(cleanUrl(),sendToWrapper("loginBoxOpened",showLoginPopUp)),sendToWrapper(["pageLoaded","removeHiding"],!1);try{sessionStorage.getItem("afterReg")&&(t=sessionStorage.getItem("_uinfo")?{key:"_uinfo",value:sessionStorage.getItem("_uinfo")}:{key:"_uinfo",value:'{"info":"unknown"}'},sendPageViewToGTM("/FP/account-created/",t,()=>{sessionStorage.removeItem("afterReg"),sessionStorage.removeItem("_uinfo")}))}catch(e){}}),(t,a)=>{showLoadingOverlay();let e=e=>{$.ajax({url:pathLangPrefix+"/services/forgot-password/",data:{email:t,passwordConfirmation:a,action:"resetPasswordConfirm","cf-turnstile-response":e},cache:!1,type:"POST",dataType:"json",xhrFields:{withCredentials:!0},success:e=>{hideLoadingOverlay(),e.error?showModal({text:e.errorMsg,type:"error",buttons:[{color:"green",text:jsTranslations.close_btn,callback:()=>{closeModal()}}],moreInfo:{url:"/faq/#results",text:jsTranslations.help_txt},showCloseButton:!0}):resetPassword(t,e.tempPass)}})};window.onloadTurnstileCallback=()=>{turnstile.render("#cf-pass-challenge",{sitekey:"0x4AAAAAAAzJMXHD9sjkA7Ox","retry-interval":3e3,callback:e,"timeout-callback":()=>{e("")},"error-callback":()=>{e("")},"refresh-expired":"never","response-field":!1})},$(document.body).append('<div id="cf-pass-challenge" style="position:absolute;width:1px;height:1px;opacity:0;"></div>'),loadMapFiles(["https://challenges.cloudflare.com/turnstile/v0/api.js?render=explicit&onload=onloadTurnstileCallback"])}),resetPassword=(a,o)=>{"object"!=typeof turnstile&&loadMapFiles(["https://challenges.cloudflare.com/turnstile/v0/api.js?render=explicit"]),showModal({text:jsTranslations.pass_reset_desc,type:"account",customClass:"reset-pass-modal",buttons:[{color:"green",text:jsTranslations.pass_reset_btn,callback:()=>{if(!$("#modals-buttons-container .btn").hasClass("disabled")){let t=getModalForm(),e="";switch(!0){case t.password.length<4||20<t.password.length:e=jsTranslations.pass_length_err;break;case!t["cf-turnstile-response"]||t["cf-turnstile-response"].length<5:e=jsTranslations.turnstile_err}closeModal(),""!==e?showModal({text:e,type:"error",buttons:[{color:"green",text:jsTranslations.take_back_btn,callback:()=>{closeModal(),resetPassword(a,o)}},{color:"orange",text:jsTranslations.cancel_btn,callback:()=>{closeModal()}}]}):(showLoadingOverlay(),$.ajax({url:pathLangPrefix+"/services/signup/",data:{password:o,newPassword:t.password,email:a,action:"resetPassword","cf-turnstile-response":t["cf-turnstile-response"]},cache:!1,type:"POST",dataType:"json",xhrFields:{withCredentials:!0},success:e=>{hideLoadingOverlay(),"NOTCHANGED"===e.result?showModal({text:e.reason,type:"error",buttons:[{color:"green",text:jsTranslations.take_back_btn,callback:()=>{closeModal(),resetPassword(a,o)}},{color:"orange",text:jsTranslations.cancel_btn,callback:()=>{closeModal()}}]}):"CHANGED"===e.result&&(createCookie("_user","1",1),createCookie("_existing","1",365),sendToWrapper(["login",a,t.password],!1),sendPageViewToGTM("/FP/loginSuccess/",window.btoa(a),()=>{showModal({text:jsTranslations.pass_change_success,type:"success",buttons:[{color:"green",text:jsTranslations.take_home_btn,callback:()=>{location.href=window.location.protocol+"//"+window.location.hostname}}]})}))}}))}}},{color:"orange",text:jsTranslations.cancel_btn,callback:()=>{closeModal()}}],showCloseButton:!0,inputs:[{type:"password",name:"password",placeHolder:jsTranslations.password_new_placeholder}],onShow:()=>{addTurnstile()}})},buildGtmCallback=t=>e=>{e.startsWith("GTM-")&&"function"==typeof t&&t()},sendPageViewToGTM=(e,t,a)=>{if("undefined"!=typeof dataLayer&&"undefined"!=typeof google_tag_manager&&"boolean"==typeof window.isGTMLoaded&&window.isGTMLoaded){e={GA_FP:e,event:"GTM FP To GA"};"object"==typeof t?e[t.key]=t.value:"string"==typeof t&&(e.event="GTM FP and DM To GA",e.dimension1=t),"function"==typeof a&&(e.eventCallback=buildGtmCallback(a));try{dataLayer.push(e)}catch(e){"function"==typeof a&&a()}}else"function"==typeof a&&a()},sendEcomStepToGTM=(e,t,a)=>{if("undefined"!=typeof dataLayer&&"undefined"!=typeof google_tag_manager&&"boolean"==typeof window.isGTMLoaded&&window.isGTMLoaded){e={GA_ECOM_ACTION:e,GA_ECOM_STEP:t,event:"GTM ECA To GA"};"function"==typeof a&&(e.eventCallback=buildGtmCallback(a));try{dataLayer.push(e)}catch(e){"function"==typeof a&&a()}}else"function"==typeof a&&a()},showContactUs=()=>{showModal({text:jsTranslations.contactus_desc,type:"warning",buttons:[{color:"green",text:jsTranslations.contactus_btn,callback:()=>{closeModal(),window.location.href="mailto:support@cheaterbuster.email?body="+encodeURIComponent("\n\n\n\n----\n\n"+jsTranslations.contactus_email_txt)}},{color:"orange",text:jsTranslations.cancel_btn,callback:()=>{closeModal()}}]})},showForgotPassword=()=>{"object"!=typeof turnstile&&loadMapFiles(["https://challenges.cloudflare.com/turnstile/v0/api.js?render=explicit"]),showModal({text:jsTranslations.forgot_pass_desc,type:"account",buttons:[{color:"green",text:jsTranslations.forgot_pass_btn,callback:()=>{if(!$("#modals-buttons-container .btn").hasClass("disabled")){let t=getModalForm(),e="";switch(!0){case!validateEmail(t.email):e=jsTranslations.valid_email_err;break;case!t["cf-turnstile-response"]||t["cf-turnstile-response"].length<5:e=jsTranslations.turnstile_err}closeModal(),""!==e?showModal({text:e,type:"error",buttons:[{color:"green",text:jsTranslations.take_back_btn,callback:()=>{closeModal(),showForgotPassword()}},{color:"orange",text:jsTranslations.cancel_btn,callback:()=>{closeModal()}}],moreInfo:{url:"/faq/#account",text:jsTranslations.help_txt}}):(showLoadingOverlay(),t.action="sendResetInstructions",$.ajax({url:pathLangPrefix+"/services/forgot-password/",data:t,cache:!1,type:"POST",xhrFields:{withCredentials:!0},success:e=>{hideLoadingOverlay(),showModal({text:jsTranslations.forgot_pass_succ_1+" "+t.email+" "+jsTranslations.forgot_pass_succ_2,type:"success",buttons:[{color:"green",text:jsTranslations.close_btn,callback:()=>{closeModal()}}],moreInfo:{url:"/faq/#account",text:jsTranslations.help_txt}})},error:()=>{hideLoadingOverlay()}}))}}},{color:"orange",text:jsTranslations.cancel_btn,callback:()=>{closeModal()}}],showCloseButton:!0,inputs:[{type:"email",name:"email",placeHolder:jsTranslations.email}],onShow:()=>{addTurnstile()}})},initMap=n=>{if("object"!=typeof jsTranslations)$(document).on("translations-loaded",()=>{initMap(n)});else{let a,o,e=$("#boxMap"),t=(e,t)=>{o?o.setLngLat([e,t]).addTo(a):o=(new mapboxgl.Marker).setLngLat([e,t]).addTo(a),document.getElementById("lat").value=t,document.getElementById("lng").value=e,$(".mapboxgl-ctrl-geocoder--icon-close").click(()=>{document.getElementById("lat").value=0,document.getElementById("lng").value=0})},s=()=>{$(".mapboxgl-ctrl-geocoder--input").keypress(e=>{"13"==e.which&&(e.preventDefault(),$(e.target).blur())})};mapboxgl.accessToken=window.atob(e.data("info")),e.removeData("info"),e.removeAttr("data-info"),a=new mapboxgl.Map({container:"boxMap",style:jsTranslations.mapbox_map,center:[n.center_lng,n.center_lat],zoom:2,dragRotate:!1}),$(".location-search-container input")[0]&&$(".location-search-container input").remove();var r=new MapboxGeocoder({accessToken:mapboxgl.accessToken,marker:!1,mapboxgl:mapboxgl,language:jsTranslations.lang_prefix,placeholder:jsTranslations.map_searchbox});if(a.addControl(r),r.addTo(".location-search-container"),r.on("result",e=>{e&&e.result&&e.result.center&&2===e.result.center.length&&t(e.result.center[0],e.result.center[1])}),a.addControl(new mapboxgl.NavigationControl),a.on("click",e=>{e&&e.lngLat&&t(e.lngLat.lng,e.lngLat.lat)}),a.loaded()?$(".location-container .map").addClass("mapLoaded"):a.on("load",e=>{$(".location-container .map").addClass("mapLoaded")}),s(),isMobile.any()&&"ontouchstart"in document.documentElement){a.dragPan.disable(),a.scrollZoom.disable(),a.touchPitch.disable(),$(".mapboxgl-touch-zoom-rotate").append('<div id="map-touch-overlay" class="hidden"><p>'+jsTranslations.map_drag+"</p></div>");let t=$("#map-touch-overlay");a.on("touchstart",e=>{e=e.originalEvent;e&&"touches"in e&&(1<e.touches.length?(e.stopImmediatePropagation(),a.dragPan.enable()):a.dragPan.disable())}),a.on("touchmove",e=>{e=e.originalEvent;e&&"touches"in e&&(1<e.touches.length?t.hasClass("hidden")||t.addClass("hidden"):t.hasClass("hidden")&&t.removeClass("hidden"))}),a.on("touchend",e=>{t.hasClass("hidden")||t.addClass("hidden")})}}},validateEmail=e=>/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i.test(e),loadMapFiles=o=>new Promise(async(e,t)=>{let a=0,n=()=>{++a===o.length&&e()};o.forEach((e,t)=>{var a,o,s;-1!==e.indexOf(".css")?(a=e,o=n,(s=document.createElement("link")).rel="stylesheet",s.href=a,s.addEventListener("error",o),s.addEventListener("load",o),document.body.appendChild(s)):-1!==e.indexOf(".js")&&(a=e,o=n,(s=document.createElement("script")).src=a,s.async=!0,s.addEventListener("error",o),s.addEventListener("load",o),document.body.appendChild(s))})}),sendToWrapper=(a,t)=>{try{let t="";if("string"==typeof a)t=a;else for(let e=0;e<a.length;e++)t=t+a[e]+":";window.webkit.messageHandlers.observe.postMessage(t)}catch(e){"function"==typeof t&&t()}},showSignUpPopUp=(e,o)=>{e&&e.preventDefault(),"object"!=typeof turnstile&&loadMapFiles(["https://challenges.cloudflare.com/turnstile/v0/api.js?render=explicit"]);try{o=new URL(o)}catch(e){o=!1}showModal({title:jsTranslations.signup,text:"",type:"account",customClass:"login-modal",buttons:[{color:"",text:jsTranslations.signup,callback:()=>{if(!$("#modals-buttons-container .btn").hasClass("disabled")){let a=getModalForm(),e="";switch(!0){case!validateEmail(a.email):e=jsTranslations.valid_email_err;break;case!a.password||a.password.length<4||20<a.password.length:e=jsTranslations.pass_length_err;break;case a.ftsu&&a.confirmPassword!==a.password:e=jsTranslations.pass_match_err;break;case!a["cf-turnstile-response"]||a["cf-turnstile-response"].length<5:e=jsTranslations.turnstile_err}closeModal(),""!==e?showModal({text:e,type:"error",buttons:[{color:"green",text:jsTranslations.take_back_btn,callback:()=>{closeModal(),showSignUpPopUp(null,o)}},{color:"orange",text:jsTranslations.cancel_btn,callback:()=>{closeModal(),o&&(showLoadingOverlay(),window.location.href=o.toString())}}],moreInfo:{url:"/faq/#account",text:jsTranslations.help_txt}}):(showLoadingOverlay(),o&&(a.subsFlow="1"),$.ajax({url:pathLangPrefix+"/services/signup/",data:a,cache:!1,type:"POST",dataType:"json",xhrFields:{withCredentials:!0},success:t=>{switch(t.result){case"OK":case"MUSTPAY":if(createCookie("_user","1",1),createCookie("_existing","1",365),sendToWrapper(["login",a.email,a.password],!1),a.ftsu)try{sessionStorage.setItem("afterReg","1"),sessionStorage.setItem("_uinfo",'{"email":"'+a.email+'","search_geo":[0,0],"search_term":""}')}catch(e){}sendPageViewToGTM("/FP/loginSuccess/",window.btoa(a.email),()=>{if(o)if("MUSTPAY"===t.result){try{sessionStorage.setItem("new_subs",o.toString())}catch(e){}navigateWithLang("/new-subscription/")}else window.location.href=o.toString();else if("MUSTPAY"===t.result)navigateWithLang("/payment/");else if(void 0!==a.ftsu)location.reload();else try{var e;sessionStorage.getItem("_gtp")?(e=sessionStorage.getItem("_gtp"),sessionStorage.removeItem("_gtp"),navigateWithLang(e)):navigateWithLang("/my-profile/")}catch(e){navigateWithLang("/my-profile/")}});break;default:hideLoadingOverlay(),"RESETPASS"===t.errorCode?resetPassword(a.email,a.password):showModal({text:t.reason,type:"error",buttons:[{color:"green",text:jsTranslations.try_again,callback:()=>{closeModal(),showSignUpPopUp(null,o)}},{color:"orange",text:jsTranslations.cancel_btn,callback:()=>{closeModal(),o&&(showLoadingOverlay(),window.location.href=o.toString())}}],moreInfo:{url:"/faq/#account",text:jsTranslations.help_txt}})}},error:()=>{hideLoadingOverlay(),showModal({text:jsTranslations.signin_err,type:"error",buttons:[{color:"green",text:jsTranslations.try_again,callback:()=>{closeModal(),showSignUpPopUp(null,o)}},{color:"orange",text:jsTranslations.cancel_btn,callback:()=>{closeModal(),o&&(showLoadingOverlay(),window.location.href=o.toString())}}],moreInfo:{url:"/faq/#account",text:jsTranslations.help_txt}})}}))}}}],moreInfo:{url:"javascript:showForgotPassword();",text:jsTranslations.forgot_pass_q},showCloseButton:!0,inputs:[{type:"email",name:"email",placeHolder:jsTranslations.email},{type:"password",name:"password",placeHolder:jsTranslations.password},{type:"password",name:"confirmPassword",placeHolder:jsTranslations.confirm_pass_holder},{type:"checkbox",name:"ftsu",placeHolder:jsTranslations.i_am_new}],onShow:()=>{let e=$('#modal-form input[name="ftsu"]'),t=$('#modal-form input[name="confirmPassword"]'),a=$('#modal-form input[name="password"]');e.prop("checked",!0),e.change(e=>{$(e.currentTarget).is(":checked")?(t.show(),a.attr("autocomplete","new-password"),t.attr("autocomplete","new-password"),$(".modal-content h2.title").text(jsTranslations.signup),$("#modals-buttons-container .btn").text(jsTranslations.signup)):(t.hide(),a.attr("autocomplete","current-password"),t.attr("autocomplete","current-password"),$(".modal-content h2.title").text(jsTranslations.login),$("#modals-buttons-container .btn").text(jsTranslations.login))}),a.attr("autocomplete","current-password"),addTurnstile()},onClose:e=>{$('#modal-form input[name="ftsu"]').off("change"),o&&e&&e.target&&e.target.classList.contains("modal-close")&&(window.location.href=o.toString())}}),$('#modal-form label[for="password"] span.password').on("click",()=>{"password"===$("#modal-form input#password").attr("type")?$("#modal-form input#password").attr("type","text"):$("#modal-form input#password").attr("type","password")}),$('#modal-form label[for="confirmPassword"] span.password').on("click",()=>{"password"===$("#modal-form input#confirmPassword").attr("type")?$("#modal-form input#confirmPassword").attr("type","text"):$("#modal-form input#confirmPassword").attr("type","password")}),sendToWrapper("loginBoxOpened",!1)},showLoginPopUp=(e,o)=>{e&&e.preventDefault(),"object"!=typeof turnstile&&loadMapFiles(["https://challenges.cloudflare.com/turnstile/v0/api.js?render=explicit"]);try{o=new URL(o)}catch(e){o=!1}let t={url:"javascript:showForgotPassword();",text:jsTranslations.forgot_pass_q};showAutofilled&&(t={url:"javascript:showAutofilledSteps();",text:jsTranslations.autofilled_steps}),showModal({title:jsTranslations.login,text:"",type:"account",customClass:"login-modal",shouldWrap:!0,buttons:[{color:"",text:jsTranslations.login,callback:()=>{if(!$("#modals-buttons-container .btn").hasClass("disabled")){let a=getModalForm(),e="";switch(!0){case!validateEmail(a.email):e=jsTranslations.valid_email_err;break;case!a.password||a.password.length<4||20<a.password.length:e=jsTranslations.pass_length_err;break;case a.ftsu&&a.confirmPassword!==a.password:e=jsTranslations.pass_match_err;break;case!a["cf-turnstile-response"]||a["cf-turnstile-response"].length<5:e=jsTranslations.turnstile_err}closeModal(),""!==e?showModal({text:e,type:"error",buttons:[{color:"green",text:jsTranslations.take_back_btn,callback:()=>{closeModal(),showLoginPopUp(null,o)}},{color:"orange",text:jsTranslations.cancel_btn,callback:()=>{closeModal(),o&&(showLoadingOverlay(),window.location.href=o.toString())}}],moreInfo:{url:"/faq/#account",text:jsTranslations.help_txt}}):(showLoadingOverlay(),o&&(a.subsFlow="1"),$.ajax({url:pathLangPrefix+"/services/signup/",data:a,cache:!1,type:"POST",dataType:"json",xhrFields:{withCredentials:!0},success:t=>{switch(t.result){case"OK":case"MUSTPAY":if(createCookie("_user","1",1),createCookie("_existing","1",365),sendToWrapper(["login",a.email,a.password],!1),a.ftsu)try{sessionStorage.setItem("afterReg","1"),sessionStorage.setItem("_uinfo",'{"email":"'+a.email+'","search_geo":[0,0],"search_term":""}')}catch(e){}sendPageViewToGTM("/FP/loginSuccess/",window.btoa(a.email),()=>{if(o)if("MUSTPAY"===t.result){try{sessionStorage.setItem("new_subs",o.toString())}catch(e){}navigateWithLang("/new-subscription/")}else window.location.href=o.toString();else if("MUSTPAY"===t.result)navigateWithLang("/payment/");else if(void 0!==a.ftsu)location.reload();else try{var e;sessionStorage.getItem("_gtp")?(e=sessionStorage.getItem("_gtp"),sessionStorage.removeItem("_gtp"),navigateWithLang(e)):navigateWithLang("/my-profile/")}catch(e){navigateWithLang("/my-profile/")}});break;default:hideLoadingOverlay(),"RESETPASS"===t.errorCode?resetPassword(a.email,a.password):showModal({text:t.reason,type:"error",buttons:[{color:"green",text:jsTranslations.try_again,callback:()=>{closeModal(),showSignUpPopUp(null,o)}},{color:"orange",text:jsTranslations.cancel_btn,callback:()=>{closeModal(),o&&(showLoadingOverlay(),window.location.href=o.toString())}}],moreInfo:{url:"/faq/#account",text:jsTranslations.help_txt}})}},error:()=>{hideLoadingOverlay(),showModal({text:jsTranslations.signin_err,type:"error",buttons:[{color:"green",text:jsTranslations.try_again,callback:()=>{closeModal(),showSignUpPopUp(null,o)}},{color:"orange",text:jsTranslations.cancel_btn,callback:()=>{closeModal(),o&&(showLoadingOverlay(),window.location.href=o.toString())}}],moreInfo:{url:"/faq/#account",text:jsTranslations.help_txt}})}}))}}}],moreInfo:t,showCloseButton:!0,inputs:[{type:"email",name:"email",placeHolder:jsTranslations.email},{type:"password",name:"password",placeHolder:jsTranslations.password},{type:"password",name:"confirmPassword",placeHolder:jsTranslations.confirm_pass_holder},{type:"checkbox",name:"ftsu",placeHolder:jsTranslations.i_am_new}],onShow:()=>{let e=$('#modal-form input[name="ftsu"]'),t=$('#modal-form input[name="confirmPassword"]'),a=$('#modal-form input[name="password"]');e.change(e=>{$(e.currentTarget).is(":checked")?(t.show(),a.attr("autocomplete","new-password"),t.attr("autocomplete","new-password"),$(".modal-content h2.title").text(jsTranslations.signup),$("#modals-buttons-container .btn").text(jsTranslations.signup)):(t.hide(),a.attr("autocomplete","current-password"),t.attr("autocomplete","current-password"),$(".modal-content h2.title").text(jsTranslations.login),$("#modals-buttons-container .btn").text(jsTranslations.login))}),a.attr("autocomplete","current-password"),t.hide(),addTurnstile()},onClose:e=>{$('#modal-form input[name="ftsu"]').off("change"),o&&e&&e.target&&e.target.classList.contains("modal-close")&&(window.location.href=o.toString())}}),$('#modal-form label[for="password"] span.password').on("click",()=>{"password"===$("#modal-form input#password").attr("type")?$("#modal-form input#password").attr("type","text"):$("#modal-form input#password").attr("type","password")}),$('#modal-form label[for="confirmPassword"] span.password').on("click",()=>{"password"===$("#modal-form input#confirmPassword").attr("type")?$("#modal-form input#confirmPassword").attr("type","text"):$("#modal-form input#confirmPassword").attr("type","password")}),sendToWrapper("loginBoxOpened",!1)},showAutofilledSteps=e=>{e&&e.preventDefault(),closeModal();e="<div class='ap-steps-overlay'><div id='autofilledSteps'><div id='closeSteps' onclick='javascript:closeAutofilledSteps();'></div><div class='ap-steps-container'><p class='rebranded'>"+jsTranslations.autofilled_steps_text_1+"</p><p class='passSaved red-text'>"+jsTranslations.autofilled_steps_text_2+"</p><p class='get-help'>"+jsTranslations.get_help+"</p><div class='browsers-container'><div class='safari-steps' onclick=javascript:showSteps('safari');></div><div class='chrome-steps' onclick=javascript:showSteps('chrome');></div></div></div></div>";$("body").append(e)},closeAutofilledSteps=()=>{showAutofilled=!1,$(".ap-steps-overlay").remove(),showLoginPopUp(null,null)},showSteps=e=>{e="<div class='steps-gif "+e+"'></div>";$(".ap-steps-container").html(e)},showLoadingOverlay=()=>{var e,t;$(".overlay-loading")[0]||(e=document.createElement("div"),t=document.createElement("div"),e.className="overlay-loading",t.className="spinner-loading",document.body.appendChild(e),e.appendChild(t)),$(".overlay-loading").show()},hideLoadingOverlay=()=>{$(".overlay-loading").hide()},logout=()=>{$.post(pathLangPrefix+"/services/functions.php?method=logout",e=>{1==e?(eraseCookie("_user"),sendToWrapper("logout",!1),navigateWithLang(window.location.protocol+"//"+window.location.hostname)):showModal({text:jsTranslations.logout_err,type:"error",buttons:[{color:"green",text:jsTranslations.close_btn,callback:()=>{closeModal()}}],moreInfo:{url:"/faq/#results",text:jsTranslations.help_txt},showCloseButton:!0})})},createCookie=(e,t,a)=>{let o;var s;o=a?((s=new Date).setTime(s.getTime()+24*a*60*60*1e3),"; expires="+s.toGMTString()):"",document.cookie=e+"="+t+o+";domain=."+siteDomain+";path=/"},readCookie=e=>{var a=e+"=",o=document.cookie.split(";");for(let t=0;t<o.length;t++){let e=o[t];for(;" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(a))return e.substring(a.length,e.length)}return null},eraseCookie=e=>{createCookie(e,"",-1)},showModal=t=>{var e=void 0!==t.shouldWrap&&t.shouldWrap;let a='<div class="top-icon"></div>';if(void 0!==t.title&&(a+='<h2 class="title">'+t.title+"</h2>"),a=(a+='<div class="form-container">')+("<p>"+t.text+"</p>"),void 0!==t.inputs){a+='<form id="modal-form">';for(let e=0;e<t.inputs.length;e++){if("radio"===t.inputs[e].type?a+='<label for="'+t.inputs[e].name+e+'">':a+='<label for="'+t.inputs[e].name+'">',void 0!==t.inputs[e].noLabelText&&!1!==t.inputs[e].noLabelText||(a+=t.inputs[e].placeHolder),"radio"===t.inputs[e].type?a+='<input type="'+t.inputs[e].type+'" name="'+t.inputs[e].name+'" id="'+t.inputs[e].name+e+'"':a+='<input type="'+t.inputs[e].type+'" name="'+t.inputs[e].name+'" id="'+t.inputs[e].name+'"',t.inputs[e].customClass?a+=' class="'+t.inputs[e].customClass+" "+t.inputs[e].type+'"':a+=' class="'+t.inputs[e].type+'"',void 0!==t.inputs[e].autocomplete&&(a+=t.inputs[e].autocomplete?' autocomplete="on"':' autocomplete="off"'),void 0!==t.inputs[e].autocapitalize&&(a+=t.inputs[e].autocapitalize?' autocapitalize="on"':' autocapitalize="off"'),void 0!==t.inputs[e].options&&"object"==typeof t.inputs[e].options)for(var o in t.inputs[e].options)a+=` ${o}="${t.inputs[e].options[o]}"`;a+=' placeholder="'+t.inputs[e].placeHolder+'">',"email"!==t.inputs[e].type&&"password"!==t.inputs[e].type||(a+='<span class="'+t.inputs[e].type+'"></span>'),a+="</label>"}a+='<input class="hiddenSubmit" type="submit" />'}e||(a+="</form>"),void 0!==t.buttons&&(a+='<div id="modals-buttons-container"></div>'),void 0!==t.moreInfo&&(a+='<a class="more-info" href="'+t.moreInfo.url+'">'+t.moreInfo.text+"</a>"),e&&(a+="</form>"),a+="</div>",$(".modal-overlay .modal-content").html(a),$(".modal-overlay")[0].className="modal-overlay",$(".modal-overlay").addClass("type-"+t.type),"string"==typeof t.customClass&&$(".modal-overlay").addClass(t.customClass),$("#modal-form")[0]&&$("#modal-form").off("submit").one("submit",e=>{e.preventDefault(),$("#modals-buttons-container div:first-child").click()});var s=document.getElementById("modals-buttons-container");if(void 0!==t.buttons)for(let e=0;e<t.buttons.length;e++){var n=document.createElement("div");n.className="btn",t.buttons[e].customClass&&(n.className+=" "+t.buttons[e].customClass),t.buttons[e].color&&(n.className+=" "+t.buttons[e].color+"-color"),n.innerHTML=t.buttons[e].text,s.appendChild(n),n.onclick=t.buttons[e].callback}void 0!==t.showCloseButton&&t.showCloseButton&&((e=document.createElement("div")).className="modal-close",e.innerHTML="+",s.appendChild(e),e.onclick=closeModal),$("body").addClass("modalOpen"),"function"==typeof t.onClose&&(window.onModalClose=t.onClose),"function"==typeof t.onShow&&t.onShow(),"number"==typeof t.timer&&setTimeout(closeModal,t.timer)},getModalForm=()=>{let t={};return $("#modal-form").serializeArray().map(e=>{t[e.name]=e.value}),t},closeModal=e=>{$("body").removeClass("modalOpen"),"function"==typeof window.onModalClose&&(window.onModalClose(e),delete window.onModalClose)},cleanUrl=()=>{try{window.history.replaceState?window.history.replaceState({},document.title,window.location.pathname):window.history.pushState&&window.history.pushState({},document.title,window.location.pathname)}catch(e){}},changeLanguage=e=>{var t;e!==pathLangPrefix&&(t=e&&1<e.length?e.replace(/[^A-Za-z\s!?]/g,"").toUpperCase():"EN",createCookie("p_lang",t,365),setTimeout(()=>{window.location.href=2<pathLangPrefix.length?window.location.pathname.replace(pathLangPrefix,e)+window.location.search:e+window.location.pathname+window.location.search},50))},navigateWithLang=t=>{if(t.startsWith("http"))try{var e=new URL(t),a=e.pathname.split("/");2<a.length&&enabledLangs.includes(a[1].toUpperCase())?"/"+a[1].toLowerCase()===pathLangPrefix?window.location.href=t:window.location.href=e.protocol+"//"+e.hostname+e.pathname.replace("/"+a[1],pathLangPrefix)+e.search:2<pathLangPrefix.length?window.location.href=e.protocol+"//"+e.hostname+pathLangPrefix+e.pathname+e.search:window.location.href=t}catch(e){2<pathLangPrefix.length&&t.endsWith(pathLangPrefix)?window.location.href=t:window.location.href=t+(t.endsWith("/")?pathLangPrefix.replace("/",""):pathLangPrefix)+"/"}else t.startsWith("/blog")||(t.startsWith("/")||(t="/"+t),2<pathLangPrefix.length&&t.startsWith(pathLangPrefix+"/"))?window.location.href=t:window.location.href=pathLangPrefix+t},addTurnstile=()=>{"function"!=typeof window.turnstileSuccess&&(window.turnstileSuccess=()=>{$("#modals-buttons-container .btn").removeClass("disabled")}),$("form#modal-form input").last().before('<div class="cf-turnstile-holder"><div class="cf-turnstile" data-callback="turnstileSuccess" data-sitekey="0x4AAAAAAAzImBQ_61cOH9dR"></div></div></div>');let e=setInterval(()=>{"object"==typeof turnstile&&(clearInterval(e),turnstile.render(".cf-turnstile"))},150);$("#modals-buttons-container .btn").addClass("disabled")};